{"version":3,"file":"state-speech-synth.js","sources":["../node_modules/state-speech-synth/dist-web/index.js"],"sourcesContent":["let changeHandlers = {};\n\nconst chr4 = () => Math.random().toString(16).slice(-4);\n/**\n * Generates a sufficiently random string.\n * Each of the resulting strings need to be unique so they can be used as keys in an object without clashing or overwriting.\n * @returns {string}\n */\n\n\nconst generateHandlerKey = () => \"\".concat(Date.now(), \"-\").concat(chr4()).concat(chr4());\n/**\n * Adds a new `changeHandler` function to the `changeHandlers` object.\n * Returns a function that will remove the `changeHandler` from the object.\n * @param {function(): *} changeHandler\n * @returns {function(): boolean}\n */\n\n\nfunction onStateChange(changeHandler) {\n  const key = generateHandlerKey();\n  changeHandlers[key] = changeHandler;\n  return () => delete changeHandlers[key];\n}\n\nconst IDLE = Symbol(\"idle\"),\n      PROCESSING = Symbol(\"processing\"),\n      PLAYING = Symbol(\"playing\"),\n      PAUSED = Symbol(\"paused\");\nconst states = {\n  [IDLE]: {\n    process: PROCESSING\n  },\n  [PROCESSING]: {\n    start: PLAYING,\n    end: IDLE,\n    pause: PAUSED\n  },\n  [PLAYING]: {\n    end: IDLE,\n    pause: PAUSED\n  },\n  [PAUSED]: {\n    end: IDLE,\n    resume: PLAYING\n  }\n};\nlet currentState = IDLE;\nfunction handleStateChange(event) {\n  const previousState = currentState;\n  const validTransition = states[previousState] && states[previousState][event.type];\n  if (validTransition) currentState = states[previousState][event.type];\n  Object.values(changeHandlers).forEach(handler => handler(currentState, event.type, event, validTransition));\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nwindow.speechSynthesis.getVoices(); // Sometimes voices will not load right away. This is a hack to preload the voice list.\n\nconst defaultConfig = {\n  voice: \"Alex\",\n  rate: 1,\n  volume: 1\n};\nlet config = defaultConfig;\nconst synth = window.speechSynthesis; //TODO: speak needs to throw when there is nothing in it\n\nfunction speak(text) {\n  let _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : config,\n      _ref$voice = _ref.voice,\n      voice = _ref$voice === void 0 ? config.voice : _ref$voice,\n      _ref$rate = _ref.rate,\n      rate = _ref$rate === void 0 ? config.rate : _ref$rate,\n      _ref$volume = _ref.volume,\n      volume = _ref$volume === void 0 ? config.volume : _ref$volume;\n\n  const utterance = Object.assign(new SpeechSynthesisUtterance(text), {\n    voice: speechSynthesis.getVoices().find(v => v.voice === voice),\n    rate,\n    volume,\n    onerror: handleStateChange,\n    onend: handleStateChange,\n    onstart: handleStateChange,\n    onpause: handleStateChange,\n    onresume: handleStateChange\n  });\n  synth.speak(utterance);\n  handleStateChange({\n    type: \"process\",\n    text,\n    config: {\n      voice,\n      rate,\n      volume\n    }\n  });\n}\nfunction resume() {\n  synth.resume();\n}\nfunction pause() {\n  synth.pause();\n}\nfunction cancel() {\n  synth.cancel();\n}\nfunction configure(configOptions) {\n  config = _objectSpread({}, defaultConfig, config, configOptions);\n}\n\nexport { IDLE, PAUSED, PLAYING, PROCESSING, cancel, configure, onStateChange, pause, resume, speak };\n"],"names":[],"mappings":"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"}